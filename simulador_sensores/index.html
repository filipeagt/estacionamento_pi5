<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulador de Sensores - Estacionamento</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#111}
    html,body,#app{height:100%;margin:0}
    body{display:flex;align-items:center;justify-content:center;background:#f5f6f7}
    .card{width:96vw;max-width:720px;background:#fff;border-radius:12px;box-shadow:0 6px 24px rgba(16,24,40,0.08);padding:16px;display:flex;flex-direction:column;gap:12px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{font-size:16px;margin:0}
    .controls{display:flex;gap:8px;flex-wrap:wrap}
    button{padding:8px 12px;border-radius:8px;border:0;background:#0b67ff;color:#fff;font-weight:600}
    button[disabled]{opacity:0.5}
    .grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
    .cell{padding:10px;border-radius:8px;background:#f3f4f6;display:flex;flex-direction:column;align-items:center;gap:6px}
    .slot{width:44px;height:44px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff}
    .free{background:#10b981} /* green */
    .occupied{background:#ef4444} /* red */
    .meta{font-size:12px;color:#374151}
    .conn {display:flex;align-items:center;gap:8px}
    .conn-badge {padding:6px 10px;border-radius:999px;font-weight:700;font-size:12px;color:#fff}
    .conn-connected {background:#10b981} /* green */
    .conn-connecting {background:#f59e0b} /* amber */
    .conn-disconnected {background:#6b7280} /* gray */
    footer{display:flex;justify-content:space-between;align-items:center;font-size:13px;color:#6b7280}
    @media(max-width:420px){.grid{grid-template-columns:repeat(4,1fr)}}
  </style>

  <!-- Load libraries as classic scripts (provide globals) -->
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/nanoid@4.0.0/dist/index.umd.min.js"></script>
</head>
<body>
  <div id="app" class="card" role="application" aria-label="Simulador de sensores de estacionamento">
    <header>
      <h1>Simulador - 40 sensores (MQTT)</h1>
      <div style="display:flex;align-items:center;gap:12px">
        <div class="conn" aria-hidden="false">
          <div id="connStatus" class="conn-badge conn-disconnected">Desconectado</div>
          <div class="meta" style="font-size:12px;color:#374151">Client: <code id="clientId">—</code></div>
        </div>
        <div class="controls">
          <button id="startBtn">Iniciar</button>
          <button id="stopBtn" disabled>Parar</button>
          <button id="burstBtn">Enviar Burst</button>
        </div>
      </div>
    </header>

    <section id="grid" class="grid" aria-live="polite"></section>

    <footer>
      <div class="meta">Broker: <code id="brokerText"></code></div>
      <div class="meta">Tópico inscrito: <code id="subText"></code></div>
    </footer>
  </div>

  <!-- Load sensor helper then main app as plain scripts (no modules) -->
  <script src="./sensors.js"></script>
  <script src="./app.js"></script>
</body>
</html>